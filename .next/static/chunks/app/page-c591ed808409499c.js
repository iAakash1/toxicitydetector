(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1148:(e,a,s)=>{Promise.resolve().then(s.bind(s,2867))},2867:(e,a,s)=>{"use strict";s.d(a,{ToxicityAssessment:()=>C});var r=s(5155),t=s(2115),l=s(5695),i=s(2177),n=s(221),o=s(927),d=s(5585);let c=(0,s(8188).pY)();var u=s(2596),x=s(9688);function m(){for(var e=arguments.length,a=Array(e),s=0;s<e;s++)a[s]=arguments[s];return(0,x.QP)((0,u.$)(a))}let g=t.forwardRef((e,a)=>{let{className:s,variant:t="default",size:l="default",...i}=e;return(0,r.jsx)("button",{className:m("inline-flex items-center justify-center rounded-xl text-sm font-semibold transition-colors","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2","disabled:pointer-events-none disabled:opacity-50",{default:"bg-gradient-to-r from-teal-500 via-indigo-500 to-pink-500 text-white hover:opacity-90",destructive:"bg-red-500 text-white hover:bg-red-600",outline:"border border-gray-600 bg-transparent hover:bg-gray-800",secondary:"bg-gray-700 text-white hover:bg-gray-600",ghost:"hover:bg-gray-800 text-gray-200"}[t],{default:"h-10 px-4 py-2",sm:"h-9 px-3",lg:"h-11 px-8"}[l],s),ref:a,...i})});g.displayName="Button";let h=t.forwardRef((e,a)=>{let{className:s,...t}=e;return(0,r.jsx)("div",{ref:a,className:m("glass rounded-2xl shadow-xl ring-1 ring-white/20",s),...t})});h.displayName="Card";let p=t.forwardRef((e,a)=>{let{className:s,...t}=e;return(0,r.jsx)("div",{ref:a,className:m("flex flex-col space-y-1.5 p-6 pb-4",s),...t})});p.displayName="CardHeader";let f=t.forwardRef((e,a)=>{let{className:s,...t}=e;return(0,r.jsx)("h3",{ref:a,className:m("font-bold text-2xl leading-none tracking-tight neon",s),...t})});f.displayName="CardTitle";let y=t.forwardRef((e,a)=>{let{className:s,...t}=e;return(0,r.jsx)("p",{ref:a,className:m("text-sm text-gray-300",s),...t})});y.displayName="CardDescription";let v=t.forwardRef((e,a)=>{let{className:s,...t}=e;return(0,r.jsx)("div",{ref:a,className:m("p-6 pt-0",s),...t})});v.displayName="CardContent",t.forwardRef((e,a)=>{let{className:s,...t}=e;return(0,r.jsx)("div",{ref:a,className:m("flex items-center p-6 pt-0",s),...t})}).displayName="CardFooter";let b=e=>{let{value:a,className:s,animated:t=!0}=e;return(0,r.jsx)("div",{className:m("progress-bar",s),children:(0,r.jsx)("div",{className:m("progress-bar-inner",t&&"transition-all duration-1000 ease-in-out"),style:{width:"".concat(Math.min(Math.max(a,0),100),"%")}})})},N={Healthy:"text-green-500",Manageable:"text-yellow-500",Concerning:"text-orange-500",Toxic:"text-red-500"},j=[{value:1,label:"Strongly Disagree"},{value:2,label:"Disagree"},{value:3,label:"Neutral"},{value:4,label:"Agree"},{value:5,label:"Strongly Agree"}],w=o.g1(o.Yj(),o.ai().min(1).max(5));function C(){var e;let a=(0,l.useRouter)(),[s,o]=(0,t.useState)(!1),[u,x]=(0,t.useState)(null),{data:C,isLoading:k}=c.questions.getAll.useQuery(),A=c.answers.submit.useMutation({onSuccess:e=>{if(x(e),o(!0),e.percent<25)S();else if(e.percent>=75){let e=document.querySelector(".result-card");e&&(e.classList.add("animate-shake"),setTimeout(()=>e.classList.remove("animate-shake"),1e3))}},onError:e=>{console.error("Submission error:",e),alert("Failed to submit assessment. Please try again.")}}),R=(0,i.mN)({resolver:(0,n.u)(w)}),S=()=>{let e=Date.now()+3e3,a=["#21e6c1","#2781ff","#ff38f5"];!function s(){(0,d.A)({particleCount:3,angle:60,spread:55,origin:{x:0},colors:a}),(0,d.A)({particleCount:3,angle:120,spread:55,origin:{x:1},colors:a}),Date.now()<e&&requestAnimationFrame(s)}()},T=null!=(e=null==C?void 0:C.every(e=>void 0!==R.watch(e.id)))&&e;return k?(0,r.jsx)(h,{className:"w-full max-w-2xl mx-auto",children:(0,r.jsx)(v,{className:"p-8",children:(0,r.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,r.jsx)("div",{className:"h-4 bg-gray-600 rounded w-3/4"}),(0,r.jsx)("div",{className:"h-4 bg-gray-600 rounded w-1/2"}),(0,r.jsx)("div",{className:"h-4 bg-gray-600 rounded w-2/3"})]})})}):(0,r.jsxs)(h,{className:m("w-full max-w-2xl mx-auto",s&&"result-card"),children:[(0,r.jsxs)(p,{className:"text-center",children:[(0,r.jsx)(f,{children:"Relationship Toxicity Assessment"}),(0,r.jsx)(y,{children:"Answer each question honestly to receive your personalized assessment"})]}),(0,r.jsx)(v,{children:s?u&&(0,r.jsxs)("div",{className:"space-y-6 text-center",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)(b,{value:u.percent}),(0,r.jsxs)("p",{className:m("text-3xl font-bold neon",N[u.tier]),children:[u.percent,"% Toxic"]}),(0,r.jsxs)("p",{className:"text-lg font-medium text-gray-200",children:[u.tier," Relationship"]}),(0,r.jsx)("p",{className:"text-gray-300 leading-relaxed",children:u.advice})]}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[(0,r.jsx)(g,{onClick:()=>a.push("/share/".concat(u.shareId)),variant:"outline",children:"Share Results"}),(0,r.jsx)(g,{onClick:()=>a.push("/dashboard"),variant:"secondary",children:"View History"}),(0,r.jsx)(g,{onClick:()=>{o(!1),x(null),R.reset()},variant:"ghost",children:"Take Again"})]})]}):(0,r.jsxs)("form",{onSubmit:R.handleSubmit(e=>{A.mutate({answers:e})}),className:"space-y-6",children:[null==C?void 0:C.map((e,a)=>(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("p",{className:"font-medium text-gray-200",children:[a+1,". ",e.text]}),(0,r.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-5 gap-2",children:j.map(a=>(0,r.jsxs)("label",{className:m("cursor-pointer text-center px-3 py-2 rounded-lg border border-gray-600","transition-all duration-200 text-xs sm:text-sm","hover:border-gray-500 focus-within:ring-2 focus-within:ring-teal-500",R.watch(e.id)===a.value&&"bg-gradient-to-r from-teal-500 to-pink-500 text-white border-transparent"),children:[(0,r.jsx)("input",{type:"radio",className:"sr-only",value:a.value,...R.register(e.id,{valueAsNumber:!0})}),a.label]},a.value))})]},e.id)),(0,r.jsx)(g,{type:"submit",className:"w-full",disabled:!T||A.isPending,children:A.isPending?"Calculating...":"Calculate Toxicity"})]})})]})}}},e=>{e.O(0,[807,801,441,964,358],()=>e(e.s=1148)),_N_E=e.O()}]);